Problem solved with atomicAdd

TODO
 - [ ] Cost model
